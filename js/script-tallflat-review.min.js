function parseApiJson(t){if("string"!=typeof t)return t;let e=t.trim();return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e=e.replace(/\/\/[^\n\r]*/g,"").replace(/\/\*[\s\S]*?\*\//g,""),e=e.replace(/,\s*(?=[}\]])/g,""),JSON.parse(e)}function addCart(){const t=Array.from(new Set($(".addToCart").map(function(){const t=$(this).data("products");return null==t?null:String(t).trim()}).get().filter(Boolean)));if(0===t.length)return;const e=t.map(t=>t.toUpperCase());$.ajax({url:"https://h15yyu8zof.execute-api.ap-northeast-1.amazonaws.com/prod/get_product_list_add_data",type:"POST",contentType:"application/json",dataType:"text",processData:!1,headers:{Accept:"application/json"},data:JSON.stringify({skus:e})}).done(function(t){let e;try{e=parseApiJson(t)}catch(e){return void console.error("API response JSON parse failed:",e,t)}var a=[];e&&Array.isArray(e.items)?a=e.items:e&&Array.isArray(e.data)?a=e.data:e&&Array.isArray(e.result)&&(a=e.result);const o={};a.forEach(t=>{t&&t.sku_no&&(o[String(t.sku_no).toLowerCase()]=t)}),$(".addToCart").each(function(){const t=$(this),e=t.data("products"),a=t.data("specifiedname"),n=Number(t.data("image"))||1,s=String(t.data("imagesize")||"s");if(!e)return;const r=o[String(e).toLowerCase()];if(!r)return;const i=String(r.sku_no),c=i.toUpperCase(),p=Number(r.id);let l=String(r.name||"");const u=Number(r.selling_price||0),d=Number(r.normal_price||0),m=Number(r.thumbnail_number||n),g=i.slice(0,3),h="/c/series/"+g.toLowerCase()+"/"+i.toLowerCase();a&&""!==String(a).trim()&&(l=String(a));let f="";if(u>0&&d>0&&u<d?f='<span class="mark-sale">SALE</span><span class="normalPrice">¥'+d.toLocaleString()+'（税込）</span><span class="sellingPrice">¥'+u.toLocaleString()+"（税込）</span>":u>0&&(f='<span class="sellingPrice">¥'+u.toLocaleString()+"（税込）</span>"),!Number.isFinite(p))return;const v=("000000000000"+p).slice(-12),y=("000"+Math.floor(p/100)).slice(-3),S=("00"+(m||n)).slice(-2),C="https://shiraistore.itembox.design/product/"+y+"/"+v+"/"+v+"-"+S+"-"+s+".jpg",_='<img src="'+C+'">',b='<form action="https://shirai-store.net/p/cart/add" method="post" target="_blank"><h5 class="productName">'+l+'</h5><p class="productPrice"><span>price</span>'+f+'</p><input type="hidden" name="products['+c+'].productNo" value="'+c+'"/><h6>数量</h6><div class="cartBlock"><select name="products['+c+'].quantity" class="quantitySelect"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select><button type="submit">カートに入れる</button></div></form><div class=""><a target="_blank" href="'+h+'">商品詳細を見る</a></div>';t.find(".addToCartImage").empty().prepend(_),t.find(".addToCartInner").empty().prepend(b)}),$(".quantitySelect").on("change",function(){const t=$(this).val();$(this).closest(".cartBlock").find(".quantityInput").val(t)})}).fail(function(t,e,a){console.error("get_product_list_add_data API error:",e,a,t&&t.responseText)})}$(function(){addCart()}),jQuery(function(t){t(".tab").click(function(){t(".is-active").removeClass("is-active"),t(this).addClass("is-active"),t(".is-show").removeClass("is-show");const e=t(this).index();t(".panel").eq(e).addClass("is-show")})});