function parseApiJson(t){if("string"!=typeof t)return t;let a=t.trim();return 65279===a.charCodeAt(0)&&(a=a.slice(1)),a=a.replace(/\/\/[^\n\r]*/g,"").replace(/\/\*[\s\S]*?\*\//g,""),a=a.replace(/,\s*(?=[}\]])/g,""),JSON.parse(a)}function addCart(){const t=Array.from(new Set($(".addToCart").map(function(){const t=$(this).data("products");return null==t?null:String(t).trim()}).get().filter(Boolean)));if(0===t.length)return;const a=t.map(t=>t.toUpperCase());$.ajax({url:"https://h15yyu8zof.execute-api.ap-northeast-1.amazonaws.com/prod/get_product_list_add_data",type:"POST",contentType:"application/json",dataType:"text",processData:!1,headers:{Accept:"application/json"},data:JSON.stringify({skus:a})}).done(function(t){let a;try{a=parseApiJson(t)}catch(a){return void console.error("API response JSON parse failed:",a,t)}var e=[];a&&Array.isArray(a.items)?e=a.items:a&&Array.isArray(a.data)?e=a.data:a&&Array.isArray(a.result)&&(e=a.result);const n={};e.forEach(t=>{t&&t.sku_no&&(n[String(t.sku_no).toLowerCase()]=t)}),$(".addToCart").each(function(){const t=$(this),a=t.data("products"),e=t.data("specifiedname"),o=Number(t.data("image"))||1,r=String(t.data("imagesize")||"s");if(!a)return;const i=n[String(a).toLowerCase()];if(!i)return;const s=String(i.sku_no),c=s.toUpperCase(),p=Number(i.id);let u=String(i.name||"");const l=Number(i.selling_price||0),d=Number(i.normal_price||0),h=Number(i.thumbnail_number||o),m=s.slice(0,3),f="/c/series/"+m.toLowerCase()+"/"+s.toLowerCase();e&&""!==String(e).trim()&&(u=String(e));let g="";if(l>0&&d>0&&l<d?g='<span class="mark-sale">SALE</span><span class="normalPrice">¥'+d.toLocaleString()+'（税込）</span><span class="sellingPrice">¥'+l.toLocaleString()+"（税込）</span>":l>0&&(g='<span class="sellingPrice">¥'+l.toLocaleString()+"（税込）</span>"),!Number.isFinite(p))return;const v=("000000000000"+p).slice(-12),S=("000"+Math.floor(p/100)).slice(-3),y=("00"+(h||o)).slice(-2),_="https://shiraistore.itembox.design/product/"+S+"/"+v+"/"+v+"-"+y+"-"+r+".jpg",b='<img src="'+_+'">',C='<form action="https://shirai-store.net/p/cart/add" method="post" target="_blank"><h5 class="productName">'+u+'</h5><p class="productPrice"><span>price</span>'+g+'</p><input type="hidden" name="products['+c+'].productNo" value="'+c+'"/><h6>数量</h6><div class="cartBlock"><select name="products['+c+'].quantity" class="quantitySelect"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select><button type="submit">カートに入れる</button></div></form><div class=""><a target="_blank" href="'+f+'">商品詳細を見る</a></div>';t.find(".addToCartImage").empty().prepend(b),t.find(".addToCartInner").empty().prepend(C)}),$(".quantitySelect").on("change",function(){const t=$(this).val();$(this).closest(".cartBlock").find(".quantityInput").val(t)})}).fail(function(t,a,e){console.error("get_product_list_add_data API error:",a,e,t&&t.responseText)})}function featureNaturicaCoordinate_slider(){$("#naturica-coordinate").length&&$(".product-image").each(function(t){var a=$(this);a.find(".product-slider").addClass("product-slider"+t).slick({asNavFor:".product-item-thum"+t,adaptiveHeight:!0}),a.find(".product-item-thum").addClass("product-item-thum"+t).slick({asNavFor:".product-slider"+t,vertical:!0,slidesToShow:4,focusOnSelect:!0,centerMode:!0,verticalSwiping:!0,arrows:!1,nextText:"",prevText:""})})}function featureNaturicaCoordinate_cart(){$("#naturica-coordinate").length&&($(document).on("change",".blanketQuantitySelect",function(){var t=$(this).val();$(this).parents(".productActionButton").find(".blanketQuantity").each(function(){var a=$(this).data("basequantity");$(this).val(t*a)})}),$(document).on("change",".blanketADISSelect",function(){var t=$(this).val();$(this).parents(".productActionButton").find(".blanketADIS").each(function(){$(this).val(t)})}))}$(function(){addCart(),featureNaturicaCoordinate_slider(),featureNaturicaCoordinate_cart()});