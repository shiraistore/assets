!function(){if(window.chatplus||(window.chatplus={}),!window.chatplus.ready){window.chatplus.ready=!0,window.jp_chatplus_app_accessTime||(window.jp_chatplus_app_accessTime=null),window.jpChatplusOnComplete=!1,window.__cp_c=document.__cp_c,window.__cp_d=document.__cp_d,window.__cp_t=document.__cp_t,window.__cp_p=document.__cp_p,window.__cp_f=document.__cp_f,window.__cp_p&&"object"==typeof window.__cp_p&&(window.__cp_p=JSON.stringify(window.__cp_p)),window.__cp_f&&"object"==typeof window.__cp_f&&(window.__cp_f=JSON.stringify(window.__cp_f)),window.__cp_o=document.__cp_o,document.cp_url="https://appimg.chatplus.jp",document.__cp_appimg&&(document.cp_url=document.__cp_appimg),addScript(window.__cp_d+"/assets/js/app/chatplusscript.min.js?v="+parseInt((new Date).getTime()/9e5)),window.chatplus.setCookie||(window.chatplus.setCookie=function(c_name,value,expiry_ms){if(window.navigator.cookieEnabled&&!window.chatplus.noCookie){expiry_ms=expiry_ms||63072e7;var path="/",samesite="None",secure="https:"==location.protocol,cltime,exdate=new Date(Date.now()+expiry_ms).toUTCString(),s="";s+=c_name+"="+escape(value),s+="; Path=/",s+="; Expires="+exdate,s+="; SameSite=None",secure&&(s+="; Secure"),document.cookie=s}}),window.chatplus.getCookie||(window.chatplus.getCookie=function(c_name){if(!window.navigator.cookieEnabled||window.chatplus.noCookie)return"";var st="",ed="";return document.cookie.length>0&&-1!=(st=document.cookie.indexOf(c_name+"="))?(st=st+c_name.length+1,-1==(ed=document.cookie.indexOf(";",st))&&(ed=document.cookie.length),unescape(document.cookie.substring(st,ed))):""}),window.chatplus.removeCookie||(window.chatplus.removeCookie=function(c_name){if(window.navigator.cookieEnabled&&!window.chatplus.noCookie){var path="/",samesite="None",secure,exdate,s="";s+=c_name+"=",s+="; Path=/",s+="; Expires="+"Thu, 01 Jan 1970 00:00:00 GMT",s+="; SameSite=None","https:"==location.protocol&&(s+="; Secure"),document.cookie=s}});var browser={Version:((userAgent=navigator.userAgent.toLowerCase()).match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],Safari:/safari/.test(userAgent)&&!/chrome/.test(userAgent),Opera:/opera/.test(userAgent),IE:(/msie/.test(userAgent)||/trident/.test(userAgent))&&!/opera/.test(userAgent),Mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent),Chrome:/chrome/.test(userAgent)&&!/opera/.test(userAgent)},userAgent,Tracker=function(){return this.accessTime=(new Date).getTime(),this.xmlHttp=null,this};Tracker.prototype={accessTime:null,xmlHttp:null,_lead:!1,getTitle:function(){if(document.getElementById("title")){var elmT=document.getElementsByTagName("title")[0];return browser.IE?elmT.innerHTML:elmT.firstChild.nodeValue}return document.title},displayChat:function(){var token=window.chatplus.getCookie("jp_chatplus_vtoken");if(""===token){for(var l=20,c="abcdefghijklmnopqrstuvwxyz0123456789",cl=c.length,i=0;i<l;i++)token+=c[Math.floor(Math.random()*cl)];var contracts;token+=window.__cp_c.split("_")[0],window.chatplus.setCookie("jp_chatplus_vtoken",token)}var type="c";window.__cp_t&&(type=window.__cp_t);var page_title=this.getTitle(),page_url=location.protocol+"//"+location.host+location.pathname+location.search+location.hash,referrer=document.referrer,url=window.__cp_d+"/chat/visitor/"+window.__cp_c+"/"+type;url+="?pt="+encodeURIComponent(page_title),url+="&pu="+encodeURIComponent(page_url),url+="&pr="+encodeURIComponent(referrer),url+="&c="+token,window.__cp_p&&(url+="&pp="+encodeURIComponent(window.__cp_p)),window.__cp_f&&(url+="&pf="+encodeURIComponent(window.__cp_f)),window.chatplus.noCookie&&(url+="&nc=1");var charset="UTF-8";"UTF-8"!=(charset=document.all?document.charset:document.characterSet)&&"utf-8"!=charset&&(url+="&pc="+charset),createScriptAfterRequire(document.cp_url+"/app/s/lib/jqueryc.min.js","jQueryPlus"),createScriptAfterRequire(document.cp_url+"/app/s/lib/riot/3.13.2/riot%2Bcompiler_2.min.js","riot"),createScriptAfterRequire(document.cp_url+"/app/s/lib/underscore/underscorec.min.js","underscore"),null!=window.jp_chatplus_app_accessTime&&window.jp_chatplus_app_accessTime<this.accessTime?this.accessTime=window.jp_chatplus_app_accessTime:window.jp_chatplus_app_accessTime=this.accessTime,createIframe({id:"jp.chatplus.app_chat_frame",src:url+"#"+JSON.stringify({accessTime:this.accessTime}),style:"display:none",frameborder:"no"})},nl2br:function(str){return str.replace(/(\r\n|\r|\n)/g,"<br />")},readyLead:function(){createScriptAfter(window.__cp_d+"/assets/js/app/lead.min.js"),createStyle(window.__cp_d+"/assets/css/lead.min.css")},displayLead:function(version){if(!this._lead)if(this._lead=!0,window.chatplus&&window.chatplus.displayLead)window.chatplus.displayLead(version);else var timerId=setInterval((function(){window.chatplus&&window.chatplus.displayLead&&(clearInterval(timerId),window.chatplus.displayLead(version))}),100)},track:function(){var url=window.__cp_d+"/chat/track/"+window.__cp_c+"/c";"sendBeacon"in window.navigator?window.addEventListener("unload",(function(){window.navigator.sendBeacon(url)})):"XMLHttpRequest"in window&&"addEventListener"in window?window.addEventListener("beforeunload",(function(){var xhr=new window.XMLHttpRequest;xhr.open("GET",url,!0),xhr.send()})):window.onbeforeunload=function(){var img=document.createElement("img"),parent;img.setAttribute("src",url),img.setAttribute("style","display:none;"),(document.getElementById("item")||document.getElementsByTagName("body").item(0)).appendChild(img)}},ajax:function(url,data,func,method){this.xmlHttp=new XMLHttpRequest;var self=this;if(this.xmlHttp.onreadystatechange=function(){var READYSTATE_COMPLETED=4,HTTP_STATUS_OK=200;4==this.readyState&&200==this.status&&func.call(self,this.responseText)},"GET"===method){var params=[];for(var k in data)null!=data[k]&&params.push(encodeURIComponent(k)+"="+encodeURIComponent(data[k]));this.xmlHttp.open("GET",url+"?"+params.join("&")),this.xmlHttp.send()}else this.xmlHttp.open(method||"POST",url),this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xmlHttp.send(this.encodeHTMLForm(data))},encodeHTMLForm:function(data){var params=[];for(var name in data){var value=data[name],param=encodeURIComponent(name)+"="+encodeURIComponent(value);params.push(param)}return params.join("&").replace(/%20/g,"+")},setCookie:function(c_name,value){return window.chatplus.setCookie(c_name,value)},getCookie:function(c_name){return window.chatplus.getCookie(c_name)},removeCookie:function(c_name){return window.chatplus.removeCookie(c_name)}},window.__cp_tracker=new Tracker,window.__cp_tracker.track(),window.__cp_design=null,window.__cp_vi=null,window.addEventListener("message",(function(event){if(event&&event.data){var message={};try{message="object"==typeof event.data?event.data:JSON.parse(event.data)}catch(e){}if("object"==typeof message&&"t"in message)if("update-user-callback"===message.t)window._chatplusscript_updateUser_callback&&(window._chatplusscript_updateUser_callback.call(this,message.response),window._chatplusscript_updateUser_callback=null);else if("get-lead-one-callback"===message.t)window._chatplusscript_getLeadOne_callback&&(window._chatplusscript_getLeadOne_callback.call(this,message.response),window._chatplusscript_getLeadOne_callback=null);else if("get-visitor-option-callback"===message.t)window.chatplus.option=message.response;else if("va"===message.t){var design_option={};message.data.va||(design_option.expired=!0),window.__cp_tracker.ajax(window.__cp_d+"/api/chat/design/"+window.__cp_c,design_option,(function(result_raw){var result=JSON.parse(result_raw),obj;result.reject||(event.data.ctoken&&window.chatplus.getCookie("jp_chatplus_vtoken")!=event.data.ctoken&&window.chatplus.setCookie("jp_chatplus_vtoken",event.data.ctoken),loadStartChat({parameters:message.data,configChat:result.data.chat_config,version:result.data.version,style_urls:result.data.style_urls||[],last_modified:result.data.last_modified}),loadLead(event.data.via))}))}}}),!1),window.__cp_tracker.displayChat()}function loadStartChat(data){delete Array.prototype.toJSON,delete Object.prototype.toJSON;var bodyElm=document.getElementsByTagName("body").item(0),headElm=document.getElementsByTagName("head").item(0);createStyle(document.cp_url+"/app/s/lib/font-awesome-5.13.1/css/all-cp.min.css");var _ua={Tablet:-1!=(u=window.navigator.userAgent.toLowerCase()).indexOf("windows")&&-1!=u.indexOf("touch")&&-1==u.indexOf("tablet pc")||-1!=u.indexOf("ipad")||-1!=u.indexOf("android")&&-1==u.indexOf("mobile")||-1!=u.indexOf("firefox")&&-1!=u.indexOf("tablet")||-1!=u.indexOf("kindle")||-1!=u.indexOf("silk")||-1!=u.indexOf("playbook"),Mobile:-1!=u.indexOf("windows")&&-1!=u.indexOf("phone")||-1!=u.indexOf("iphone")||-1!=u.indexOf("ipod")||-1!=u.indexOf("android")&&-1!=u.indexOf("mobile")||-1!=u.indexOf("firefox")&&-1!=u.indexOf("mobile")||-1!=u.indexOf("blackberry")},u;if(_ua.Mobile||_ua.Tablet){var screenWidth=window.screen.width,viewportWidth=window.innerWidth,support_css_variables;if(!data.configChat.appearance.themeParams.spZoom||viewportWidth<=screenWidth)createStyle(window.__cp_d+"/assets/css/chat_common.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat_sp.min.css?v="+data.version);else if(function(){try{if(CSS.supports("--css","variables"))return!0;var span=document.createElement("span");span.style.setProperty("--color","#c0ffee"),span.style.setProperty("background-color","var(--color)"),document.body.appendChild(span);var supports="rgb(192, 255, 238)"===getComputedStyle(span).backgroundColor;return document.body.removeChild(span),supports}catch(e){return!1}}()){createStyle(window.__cp_d+"/assets/css/chat_common.zoom.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat.zoom.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat_sp.zoom.min.css?v="+data.version);var style=document.createElement("style");style.setAttribute("id","chatplus_zoom"),style.textContent="#chatplusview {--zoom: "+viewportWidth/screenWidth+";}",headElm.appendChild(style);var update_zoom=function(){var style=document.getElementById("chatplus_zoom");if(style){var screenWidth=window.screen.width,viewportWidth=window.innerWidth;style.textContent="#chatplusview {--zoom: "+viewportWidth/screenWidth+";}"}};setTimeout(update_zoom,200),window.addEventListener("resize",(function(){setTimeout(update_zoom,100)}))}else createStyle(window.__cp_d+"/assets/css/chat_common.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat_sp.min.css?v="+data.version)}else createStyle(window.__cp_d+"/assets/css/chat_common.min.css?v="+data.version),createStyle(window.__cp_d+"/assets/css/chat.min.css?v="+data.version);"style_urls"in data&&data.style_urls.length>0?data.style_urls.map(createStyle):createStyle(window.__cp_d+"/api/chat/style/"+window.__cp_c+"?v="+data.last_modified);var chatTag=document.createElement("chat");bodyElm.appendChild(chatTag);var chatConfig=document.createElement("script");chatConfig.id="chat_config",chatConfig.type="application/json",chatConfig.innerText=JSON.stringify(data.configChat),bodyElm.appendChild(chatConfig),window.access_key=data.parameters.access_key,window.site_id=data.parameters.site_id,window.va=data.parameters.va,addScript(window.__cp_d+"/assets/js/app/onerror.min.js"),window.__cp_o>0?(addScript(window.__cp_d+"/assets/js/riot-tags/output.tag.js?v="+data.version,{type:"riot/tag"}),addScript(window.__cp_d+"/assets/js/riot-tags/openchat.tag.js?v="+data.version,{type:"riot/tag"}),addScript(window.__cp_d+"/assets/js/app/openchat-client.min.js?v="+data.version)):(addScript(window.__cp_d+"/assets/js/riot-tags/output.tag.js?v="+data.version,{type:"riot/tag"}),addScript(window.__cp_d+"/assets/js/riot-tags/chat.tag.js?v="+data.version,{type:"riot/tag"}),addScript(window.__cp_d+"/assets/js/app/visitor-client.min.js?v="+data.version),data.configChat.balloon&&addScript(window.__cp_d+"/assets/js/riot-tags/balloon.tag.js?v="+data.version,{type:"riot/tag"}),addScript(document.cp_url+"/app/s/lib/slick.min.js")),data.configChat.appearance.talking.useOcrScan&&(addScript(document.cp_url+"/app/s/lib/tesseract.min.js"),addScript(window.__cp_d+"/assets/js/app/chatplusscriptmedia.min.js?v="+parseInt((new Date).getTime()/9e5))),"undefined"==typeof jQueryPlus&&addScript(document.cp_url+"/app/s/lib/jqueryc.min.js"),data.configChat.externals&&data.configChat.externals.pardot&&data.configChat.externals.pardot.enabled&&jQueryPlus.ajax({url:window.__cp_d+"/assets/js/app/external/pardot.min.js",dataType:"script",cache:!0}).then((function(){data.configChat.externals.pardot.landing_url&&window.chatplus.create_pardot_landing(data.configChat),data.configChat.externals.pardot.form_url&&window.chatplus.create_pardot_form(data.configChat)})),data.configChat.externals&&data.configChat.externals.gmopg&&data.configChat.externals.gmopg.script&&addScript(data.configChat.externals.gmopg.script,{async:!0}),data.configChat.appearance.talking.suggest&&"caiwa"===data.configChat.appearance.talking.suggestSource&&jQueryPlus.ajax({url:window.__cp_d+"/assets/js/app/external/caiwa.min.js",dataType:"script",cache:!0}).then((function(){window.chatplus.caiwa=new window.chatplus.Caiwa(data.configChat.externals.caiwa.authority,data.configChat.externals.caiwa.service_id)})),window.jpChatplusOnComplete=!0}function loadLead(visitor_id){window.__cp_vi=visitor_id,window.__cp_tracker.ajax(window.__cp_d+"/api/lead/startup",{key:window.__cp_c,page:encodeURIComponent(location.protocol+"//"+location.host+location.pathname+location.search),a:visitor_id,p:window.__cp_p},(function(startup_result_raw){var startup_result=JSON.parse(startup_result_raw);if(1==startup_result.result&&startup_result.data.display){var on_leave=startup_result.data.leavepage,on_load=!on_leave;window.__cp_tracker.ajax(window.__cp_d+"/api/lead/config",{key:window.__cp_c},(function(config_result_raw){window.chatplus.getLeadState||(window.chatplus.getLeadState=function(type){try{var value=null;return window.localStorage&&null!==(value=window.localStorage.getItem("chatplus-lead-"+type+"_"+window.__cp_c))?value:""!==(value=window.chatplus.getCookie(type+window.__cp_c))?value:null}catch(e){return console.error(e),null}});var config_result=JSON.parse(config_result_raw);if(1==config_result.result){var hiddenType=parseInt(config_result.data.startup.hiddenType),version=config_result.data.version||1;switch(hiddenType){case 1:if(window.chatplus.getLeadState("ever")==version)return;break;case 2:if(window.chatplus.getLeadState("display")==version)return;break;case 4:if(window.chatplus.getLeadState("close")==version)return}if(window.__cp_design=config_result.data.appearance,window.__cp_design.checkbox=1==hiddenType,window.__cp_tracker.readyLead(),on_load)var intervalID=window.setInterval((function(){var jt;window.__cp_tracker._lead?window.clearInterval(intervalID):Math.floor((Date.now()-window.__cp_tracker.accessTime)/1e3)>=startup_result.data.time&&(window.clearInterval(intervalID),window.__cp_tracker.displayLead(version))}),200);if(on_leave){var onMouseMove=function(ev){ev.clientY<50&&onLeavePage()},onLeavePage=function(ev){window.__cp_tracker.displayLead(version),window.removeEventListener("mousemove",onMouseMove)};window.addEventListener("mousemove",onMouseMove)}}}),"GET")}}),"GET")}function createScriptAfter(sr,type){var ca=document.createElement("script"),ss=document.getElementsByTagName("script")[0];type&&(ca.type=type),ca.src=sr,ss.parentNode.insertBefore(ca,ss.nextSibling)}function createStyle(sr){var ca=document.createElement("link"),ss=document.getElementsByTagName("head")[0];ca.setAttribute("rel","stylesheet"),ca.href=sr,ss.appendChild(ca)}function createScriptAfterRequire(src,requiremodule){return addScript(src,{charset:"utf-8",async:"","data-requirecontext":"_","data-requiremodule":requiremodule,type:"text/javascript"})}function addScript(src,attr){if("a"!==window.__cp_t){var e=document.createElement("script");if(e.src=src,attr)for(var i in attr)e.setAttribute(i,attr[i]);var f=function(){var bodyElm=document.getElementsByTagName("body").item(0);bodyElm?bodyElm.appendChild(e):window.setTimeout(f,100)};f()}}function createIframe(attr){var e=document.createElement("iframe");if(attr)for(var i in attr)e.setAttribute(i,attr[i]);var f=function(){var bodyElm=document.getElementsByTagName("body").item(0);bodyElm?bodyElm.appendChild(e):window.setTimeout(f,100)};f()}}();
