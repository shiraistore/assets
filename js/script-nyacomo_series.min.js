function animation(){$(document).ready(function(){$(".footprints").css({opacity:0,position:"relative"}),$(window).on("scroll",function(){$(".footprints").each(function(){var t=$(window).scrollTop(),o=$(window).height(),e=$(this).offset().top;t+o>e&&$(this).animate({opacity:1},1e3)})})})}function parseApiJson(t){if("string"!=typeof t)return t;let o=t.trim();return 65279===o.charCodeAt(0)&&(o=o.slice(1)),o=o.replace(/\/\/[^\n\r]*/g,"").replace(/\/\*[\s\S]*?\*\//g,""),o=o.replace(/,\s*(?=[}\]])/g,""),JSON.parse(o)}function addCart(){const t=Array.from(new Set($(".addToCart").map(function(){const t=$(this).data("products");return null==t?null:String(t).trim()}).get().filter(Boolean)));if(0===t.length)return;const o=t.map(t=>t.toUpperCase());$.ajax({url:"https://h15yyu8zof.execute-api.ap-northeast-1.amazonaws.com/prod/get_product_list_add_data",type:"POST",contentType:"application/json",dataType:"text",processData:!1,headers:{Accept:"application/json"},data:JSON.stringify({skus:o})}).done(function(t){let o;try{o=parseApiJson(t)}catch(o){return void console.error("API response JSON parse failed:",o,t)}var e=[];o&&Array.isArray(o.items)?e=o.items:o&&Array.isArray(o.data)?e=o.data:o&&Array.isArray(o.result)&&(e=o.result);const n={};e.forEach(t=>{t&&t.sku_no&&(n[String(t.sku_no).toLowerCase()]=t)}),$(".addToCart").each(function(){const t=$(this),o=t.data("products"),e=t.data("specifiedname"),a=Number(t.data("image"))||1,i=String(t.data("imagesize")||"s");if(!o)return;const s=n[String(o).toLowerCase()];if(!s)return;const r=String(s.sku_no),l=r.toUpperCase(),c=Number(s.id);let d=String(s.name||"");const p=Number(s.selling_price||0),u=Number(s.normal_price||0),m=Number(s.thumbnail_number||a),f=r.slice(0,3),h="/c/series/"+f.toLowerCase()+"/"+r.toLowerCase();e&&""!==String(e).trim()&&(d=String(e));let _="";if(p>0&&u>0&&p<u?_='<span class="mark-sale">SALE</span><span class="normalPrice">¥'+u.toLocaleString()+'（税込）</span><span class="sellingPrice">¥'+p.toLocaleString()+"（税込）</span>":p>0&&(_='<span class="sellingPrice">¥'+p.toLocaleString()+"（税込）</span>"),!Number.isFinite(c))return;const g=("000000000000"+c).slice(-12),y=("000"+Math.floor(c/100)).slice(-3),v=("00"+(m||a)).slice(-2),b="https://shiraistore.itembox.design/product/"+y+"/"+g+"/"+g+"-"+v+"-"+i+".jpg",S='<img src="'+b+'">',C='<form action="https://shirai-store.net/p/cart/add" method="post" target="_blank"><h5 class="productName">'+d+'</h5><p class="productPrice"><span>price</span>'+_+'</p><input type="hidden" name="products['+l+'].productNo" value="'+l+'"/><h6>数量</h6><div class="cartBlock"><select name="products['+l+'].quantity" class="quantitySelect"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select><button type="submit">カートに入れる</button></div></form><div class=""><a target="_blank" href="'+h+'">商品詳細を見る</a></div>';t.find(".addToCartImage").empty().prepend(S),t.find(".addToCartInner").empty().prepend(C)}),$(".quantitySelect").on("change",function(){const t=$(this).val();$(this).closest(".cartBlock").find(".quantityInput").val(t)})}).fail(function(t,o,e){console.error("get_product_list_add_data API error:",o,e,t&&t.responseText)})}function initModals(){$('[class^="modal_content_"]').filter(function(){return/\d+$/.test(this.className)}).hide(),$(document).on("click",'[class*="modal_button_"]',function(t){t.preventDefault();const o=(this.className||"").split(/\s+/).find(t=>/^modal_button_\d+$/.test(t));if(!o)return;const e=o.split("_").pop(),n=".modal_content_"+e;$("#modal_content_overlay").stop(!0,!0).fadeIn(200),$(n).stop(!0,!0).fadeIn(200),$("body").addClass("no-scroll")}),$(document).on("click","#modal_content_overlay, .modal_close span",function(t){t.preventDefault(),$('[class^="modal_content_"]').filter(function(){return/\d+$/.test(this.className)}).stop(!0,!0).fadeOut(200),$("#modal_content_overlay").stop(!0,!0).fadeOut(200),$("body").removeClass("no-scroll")}),$(document).on("keyup",function(t){"Escape"===t.key&&($('[class^="modal_content_"]').filter(function(){return/\d+$/.test(this.className)}).stop(!0,!0).fadeOut(200),$("#modal_content_overlay").stop(!0,!0).fadeOut(200),$("body").removeClass("no-scroll"))})}$(function(){addCart(),animation()});var img_slider_option={infiniteLoop:!0,pager:!0,hideControlOnEnd:!0,touchEnabled:!0,auto:!0,minSlides:1,maxSlides:1,slideWidth:800,slideMargin:0},bxslider1=$(".bxslider1").bxSlider(img_slider_option);$(window).on("load resize",function(){var t=$(window).width();$(".bxslider").each(function(){t<=960?(bxslider1.destroySlider(),$(".img_slider").each(function(){$(this).addClass("destroy")})):(bxslider1.reloadSlider(img_slider_option),$(".img_slider").each(function(){$(this).removeClass("destroy")}))})}),$(function(){initModals()}),$(function(){initModals()});